"use strict";const G_L=new LangData("tpl-lang");function Tpl_TypeSet(e,t){let l="";if("tpl-cat-nginx"===e.target.id)l="nginx";else if("tpl-cat-httpd"===e.target.id)l="httpd";else{if("tpl-cat-php-fpm"!==e.target.id)return;l="php-fpm"}Cookie.setHttps("tpl-type-sel",l,43200,"/tpl/"),window.location="/tpl/"}function Tpl_NameSet(e,t){String(e.target.id).startsWith("tpl-name-")&&(Cookie.setHttps("tpl-name-sel",e.target.value,43200,"/tpl/",!0),window.location="/tpl/")}async function Tpl_Add(e,t){let l="";if("tpl-add"!=e.target.id)return;l="tpl-add";const n=new ButtonState(l),i=await fetchText_Post("/tpl/?a="+l);n.restore(),isFetchedOk(i,"/tpl/")}async function Tpl_Save(e,t){let l="";if("tpl-save"!=e.target.id)return;l="tpl-save";const n=document.getElementById("tpl-textarea");n||console.log("text element not found");const i=new ButtonState(l),o=await fetchText_Post("/tpl/?a="+l,n.value);i.restore(),isFetchedOk(o,"/tpl/")}async function Tpl_Rename(e,t){let l="";if("tpl-rename"!=e.target.id)return;l="tpl-rename";let n=Cookie.get("tpl-name-sel",!0);if(!n||"string"!=typeof n||n.length<1)return void console.log("template name cookie is invalid");n=Html.escape(n);var i=!1;const o=document.querySelectorAll("[id^=tpl-name-]");for(let e=0;e<o.length;e+=1)if(o[e].value===n){i=!0;break}if(!i)return void console.log("invalid field selected");const a=document.getElementById("tpl-rename-data");if(!a)return void console.log("tpl name field not found");const p=new ButtonState(l),s=await fetchText_Post("/tpl/?a="+l,a.value);p.restore(),isFetchedOk(s,"/tpl/")}async function Tpl_Delete(e,t){if(!params_Validate(t,"ge",2))return;let l=Cookie.get("tpl-type-sel");if(!l||"string"!=typeof l||l.length<1)return void console.log("template type cookie is invalid");l=Html.escape(l);let n=Cookie.get("tpl-name-sel",!0);if(!n||"string"!=typeof n||n.length<1)return void console.log("template name cookie is invalid");if(n=Html.escape(n),l!=t[0])return;if(n!=t[1])return;if("modal-submit"==e.target.id){const e=new ButtonState("modal-submit"),t=await fetchText_Delete("/tpl/?a=tpl-delete&t="+csrf_getPageToken());if(e.restore(),!isFetchedOk(t,"/tpl/"))return}}async function Tpl_OpenDeleteWnd(e,t){if("tpl-delete"!==e.target.id)return;let l=Cookie.get("tpl-type-sel");if(!l||"string"!=typeof l||l.length<1)return void console.log("template type cookie is invalid");l=Html.escape(l);let n=Cookie.get("tpl-name-sel",!0);if(!n||"string"!=typeof n||n.length<1)return void console.log("template name cookie is invalid");n=Html.escape(n);const i=['<div class="row jc-between h-2"><p class="modal-title">'+G_L.esc("Delete")+" "+Html.escape(l)+" "+G_L.esc("template")+'</p><span id="modal-close" class="modal-close">&times;</span></div>\n'];i.push('<hr><p class="d-block m-t1">'+G_L.esc("Next items will be deleted")+":</p>\n"),i.push('<textarea class="w-100p h-5 m-t1" readonly>'+Html.escape(n)+"</textarea>"),i.push('<a id="modal-submit" class="btn">'+G_L.esc("Confirm")+"</a>");const o=document.getElementById("modal-content");o&&(o.innerHTML=i.join("\n"));const a=document.getElementById("modal-popup");a&&(a.style.display="block"),modal_Open(null,null),listener_AddSingleById("modal-close","mouseup",null,null,modal_Close),listener_AddSingleById("modal-popup","mouseup",null,null,modal_Close),listener_AddSingleById("modal-submit","mouseup","keyup","Enter",Tpl_Delete,l,n)}common_listeners(),listener_AddSingleById("tpl-add","click","keyup","Enter",Tpl_Add),listener_AddSingleById("tpl-save","click","keyup","Enter",Tpl_Save),listener_AddSingleById("tpl-rename","click","keyup","Enter",Tpl_Rename),listener_AddSingleById("tpl-delete","click","keyup","Enter",Tpl_OpenDeleteWnd),listener_AddSingleById("tpl-cat-nginx","click","keyup","Enter",Tpl_TypeSet),listener_AddSingleById("tpl-cat-httpd","click","keyup","Enter",Tpl_TypeSet),listener_AddSingleById("tpl-cat-php-fpm","click","keyup","Enter",Tpl_TypeSet),listeners_Add("","[id^=tpl-name-]","mouseup",null,null,Tpl_NameSet,"");
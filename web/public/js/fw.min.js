"use strict";const G_L=new LangData("fw-lang");async function fw_Add_Confirm(e,t){const n=new PrepData(7);let a=!1;if(n.prepareValue(5,"#fw-add-action",!0,G_L.raw("action")+" "+G_L.raw("is required"))||(a=!0),a)return;n.prepareValue(0,"#fw-add-iop",!1,""),n.prepareValue(1,"#fw-add-ip",!1,""),n.prepareValue(2,"#fw-add-proto",!1,""),n.prepareValue(3,"#fw-add-pop",!1,""),n.prepareValue(4,"#fw-add-port",!1,""),n.prepareValue(6,"#fw-add-comment",!1,"");const i="fw-add-confirm",l=new ButtonState(i),r=await fetchText_Post("/fw/?a="+i,n.arr.join(" "));l.restore(),isFetchedOk(r,"/fw/")}async function fw_Edit_Confirm(e,t){const n=new PrepData(8);let a=!1;if(n.prepareValue(5,"#fw-edit-action",!0,G_L.raw("action")+" "+G_L.raw("is required"))||(a=!0),n.prepareValue(7,"#fw-edit-fwid",!0,G_L.raw("rule id")+" "+G_L.raw("is required"))||(a=!0),a)return;n.prepareValue(0,"#fw-edit-iop",!1,""),n.prepareValue(1,"#fw-edit-ip",!1,""),n.prepareValue(2,"#fw-edit-proto",!1,""),n.prepareValue(3,"#fw-edit-pop",!1,""),n.prepareValue(4,"#fw-edit-port",!1,""),n.prepareValue(6,"#fw-edit-comment",!1,"");const i="fw-edit-confirm",l=new ButtonState(i),r=await fetchText_Post("/fw/?a="+i,n.arr.join(" "));l.restore(),isFetchedOk(r,"/fw/")}async function fw_Move_Confirm(e,t){if(!params_Validate(t,"e",1))return void notificationNew_addError("invalid params specified");const n=document.querySelectorAll("table#"+t[0]+" tbody tr");let a=null;for(let e=0;e<n.length;e+=1)if(n[e].querySelector(".checkbox-simple-cntr input[type=checkbox]").checked&&n[e].id.length){if(a)return void notificationNew_addError(G_L.raw("select only one row for this action"));a=n[e].id}if(!a||"string"!=typeof a||a.length<1)return void notificationNew_addError(G_L.raw("no row selected"));const i=new PrepData(2);let l=!1;if(i.prepareString(0,a)||(l=!0),i.prepareValue(1,"#fw-move-idx",!0,G_L.raw("placement index")+" "+G_L.raw("is required"))||(l=!0),l)return;const r="fw-move-confirm",c=new ButtonState(r),o=await fetchText_Post("/fw/?a="+r,i.arr.join(" "));c.restore(),isFetchedOk(o,"/fw/")}async function fw_Reset_Confirm(e,t){if(!params_Validate(t,"e",2))return;if("modal-submit"!==e.target.id)return;const n=new PrepData(1);n.prepareString(0,"yes");const a=new ButtonState("modal-submit"),i=await fetchText_Post(t[0]+"&t="+csrf_getPageToken(),n.arr.join(" "));a.restore(),isFetchedOk(i,t[1])}async function fw_openResetWnd(e,t){if(!params_Validate(t,"e",5))return;const n=t[0],a=t[1],i=t[2],l=t[3],r=t[4],c=['<div class="row jc-between h-2"><p class="modal-title">'+i+'</p><span id="modal-close" class="modal-close">&times;</span></div><hr>\n'];c.push('<p class="d-block m-t1 m-b1">'+l+"</p>\n"),c.push('<a id="modal-submit" class="btn">'+r+"</a>");const o=document.getElementById("modal-content");o&&(o.innerHTML=c.join("\n"));const d=document.getElementById("modal-popup");d&&(d.style.display="block"),modal_Open(null,null),listener_AddSingleById("modal-close","mouseup",null,null,modal_Close),listener_AddSingleById("modal-popup","mouseup",null,null,modal_Close),listener_AddSingleById("modal-submit","mouseup","keyup","Enter",fw_Reset_Confirm,n,a)}async function fw_Fail2ban_Jail_On_Confirm(e,t){let n=[],a=document.getElementById("fw-fail2ban-jail-qweenx");a&&a.checked&&n.push("qweec-qweenx");let i=document.getElementById("fw-fail2ban-jail-ssh");i&&i.checked&&n.push("qweec-ssh");let l=document.getElementById("fw-fail2ban-jail-vsftpd");l&&l.checked&&n.push("qweec-vsftpd");let r=document.getElementById("fw-fail2ban-jail-exim");r&&r.checked&&n.push("qweec-exim");let c=document.getElementById("fw-fail2ban-jail-dovecot");c&&c.checked&&n.push("qweec-dovecot");let o=document.getElementById("fw-fail2ban-jail-mysql");o&&o.checked&&n.push("qweec-mysql");let d=document.getElementById("fw-fail2ban-jail-mariadb");d&&d.checked&&n.push("qweec-mariadb");const f=new PrepData(1);f.prepareString(0,n.join(","));const s=e.target.id;if("fw-fail2ban-jail-on"!==s&&"fw-fail2ban-jail-off"!==s)return;const w=new ButtonState(s),p=await fetchText_Post("/fw/?a="+s,f.arr.join(" "));w.restore(),isFetchedOk(p,"/fw/?a=fw-fail2ban&"+cache_AddNocacheParam())}async function fw_Fail2ban_Jail_Clear_Confirm(e,t){let n=[],a=document.getElementById("fw-fail2ban-jail-qweenx");a&&a.checked&&n.push("qweec-qweenx");let i=document.getElementById("fw-fail2ban-jail-ssh");i&&i.checked&&n.push("qweec-ssh");let l=document.getElementById("fw-fail2ban-jail-vsftpd");l&&l.checked&&n.push("qweec-vsftpd");let r=document.getElementById("fw-fail2ban-jail-exim");r&&r.checked&&n.push("qweec-exim");let c=document.getElementById("fw-fail2ban-jail-dovecot");c&&c.checked&&n.push("qweec-dovecot");let o=document.getElementById("fw-fail2ban-jail-mysql");o&&o.checked&&n.push("qweec-mysql");let d=document.getElementById("fw-fail2ban-jail-mariadb");d&&d.checked&&n.push("qweec-mariadb");const f=new PrepData(1);f.prepareString(0,n.join(","));const s=e.target.id;if("fw-fail2ban-jail-clear"!==s)return;const w=new ButtonState(s),p=await fetchText_Post("/fw/?a="+s,f.arr.join(" "));w.restore(),isFetchedOk(p,"/fw/?a=fw-fail2ban&"+cache_AddNocacheParam())}function fw_Fail2ban_Ipset_IpSearch_Confirm(e,t){const n=document.getElementById("fw-fail2ban-ipset-ip");!n||n.value.length<1||(window.location="/fw/?a=fw-fail2ban&ip="+encodeURIComponent(n.value)+"&"+cache_AddNocacheParam())}async function fw_Fail2ban_Ipset_IpDelete_Confirm(e,t){const n=document.getElementById("fw-fail2ban-ipset-ip");if(!n||n.value.length<1)return;const a=new ButtonState("fw-fail2ban-ipset-ip-delete"),i=await fetchText_Delete("/fw/?a=fw-fail2ban-ipset-ip-delete&"+cache_AddNocacheParam(),n.value);a.restore(),isFetchedDataValid(i)}common_listeners(),listener_AddSingleById("fw-edit","click","keyup","Enter",table_OnButtonClick_Router,"tbl-fw","/fw/?a=fw-edit&fw=",""),listener_AddSingleById("fw-add-confirm","click","keyup","Enter",fw_Add_Confirm),listener_AddSingleById("fw-move-confirm","click","keyup","Enter",fw_Move_Confirm,"tbl-fw"),listener_AddSingleById("fw-on","click","keyup","Enter",table_RunPostOnButtonClick_MultiRouter,"tbl-fw","/fw/?a=fw-on","/fw/",""),listener_AddSingleById("fw-off","click","keyup","Enter",table_RunPostOnButtonClick_MultiRouter,"tbl-fw","/fw/?a=fw-off","/fw/",""),listener_AddSingleById("fw-reset-wnd","click","keyup","Enter",fw_openResetWnd,"/fw/?a=fw-reset-confirm","/fw/",G_L.esc("Reset all firewall rules"),G_L.esc("Confirm deleting the rules and setting to defaults"),G_L.esc("Confirm")),listener_AddSingleById("fw-delete-wnd","click","keyup","Enter",table_openDeleteWnd,"tbl-fw","/fw/?a=fw-delete","/fw/",G_L.esc("Delete")+" "+G_L.esc("firewall rules"),G_L.esc("Next items will be deleted"),G_L.esc("Confirm"),null),listener_AddSingleById("fw-edit-confirm","click","keyup","Enter",fw_Edit_Confirm),listener_AddSingleById("fw-fail2ban-jail-on","click","keyup","Enter",fw_Fail2ban_Jail_On_Confirm),listener_AddSingleById("fw-fail2ban-jail-off","click","keyup","Enter",fw_Fail2ban_Jail_On_Confirm),listener_AddSingleById("fw-fail2ban-jail-clear","click","keyup","Enter",fw_Fail2ban_Jail_Clear_Confirm),listener_AddSingleById("fw-fail2ban-ipset-ip-search","click","keyup","Enter",fw_Fail2ban_Ipset_IpSearch_Confirm),listener_AddSingleById("fw-fail2ban-ipset-ip-delete","click","keyup","Enter",fw_Fail2ban_Ipset_IpDelete_Confirm),listeners_Add("table.tbl-fixed tbody","tr","mouseup",null,null,table_OnClickRouter,"/fw/?a=fw-edit&fw="),listener_AddSingleById("fws-checkbox-header","mouseup",null,null,table_SetAllCheckboxes,"table#tbl-fw tbody tr td .checkbox-simple-cntr input[type=checkbox]"),listeners_Add(null,".pageidx","click",null,null,table_SelectPage,"fw-table-page","/fw/"),listener_AddSingleById("fw-table-setting","click","keyup","Enter",tableSetting_Modal_OpenWnd,JSON.stringify({id:"fw-table-setting",cookie:"fw-table-setting",path:"/fw/",titles:[G_L.esc("Settings"),G_L.esc("Number of rows"),G_L.esc("custom"),G_L.esc("Confirm")],values:[1,2,4,8,16,32,64,128],names:["index","iop","ip","pop","port","proto","action","comment"],labels:["&#35;",G_L.esc("ip op."),G_L.esc("ip address"),G_L.esc("port op."),G_L.esc("port"),G_L.esc("protocol"),G_L.esc("action"),G_L.esc("comment")]}));